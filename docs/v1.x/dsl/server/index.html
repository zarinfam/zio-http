<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<title data-react-helmet="true">Server | ZIO-HTTP</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://github.com/zio/zio-http/docs/v1.x/dsl/server"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Server | ZIO-HTTP"><meta data-react-helmet="true" name="description" content="This section describes, ZIO HTTP Server and different configurations you can provide while creating the Server"><meta data-react-helmet="true" property="og:description" content="This section describes, ZIO HTTP Server and different configurations you can provide while creating the Server"><link data-react-helmet="true" rel="canonical" href="https://github.com/zio/zio-http/docs/v1.x/dsl/server"><link data-react-helmet="true" rel="alternate" href="https://github.com/zio/zio-http/docs/v1.x/dsl/server" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/zio/zio-http/docs/v1.x/dsl/server" hreflang="x-default"><link rel="stylesheet" href="/zio-http/assets/css/styles.c2d7348c.css">
<link rel="preload" href="/zio-http/assets/js/runtime~main.f417ffbd.js" as="script">
<link rel="preload" href="/zio-http/assets/js/main.9c568309.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zio-http/"><b class="navbar__title">ZIO-HTTP</b></a><a class="navbar__item navbar__link navbar__link--active" href="/zio-http/docs/v1.x/index">Tutorial</a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">v1.x</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/index">Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">DSL</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zio-http/docs/v1.x/dsl/server">Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/dsl/http">Http</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/dsl/request">Request</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/dsl/response">Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/dsl/body">Body</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/dsl/headers">Headers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/dsl/cookies">Cookie</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zio-http/docs/v1.x/dsl/middleware">Middleware</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Socket</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Client</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Testing</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Integrations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Examples</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Server</h1></header><p>This section describes, ZIO HTTP Server and different configurations you can provide while creating the Server </p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="start-a-zio-http-server-with-default-configurations">Start a ZIO HTTP Server with default configurations<a aria-hidden="true" class="hash-link" href="#start-a-zio-http-server-with-default-configurations" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  override def run(args: List[String]): URIO[zio.ZEnv, ExitCode] =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Server.start(8090, app.silent).exitCode</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="start-a-zio-http-server-with-custom-configurations">Start a ZIO HTTP Server with custom configurations.<a aria-hidden="true" class="hash-link" href="#start-a-zio-http-server-with-custom-configurations" title="Direct link to heading">â€‹</a></h2><ol><li>Imports required by the customised server. <div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import zio.http._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import zio.http.service.ServerChannelFactory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import zio.http.service.{EventLoopGroup, Server}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import zio._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import scala.util.Try</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>The Server can be built incrementally with a <code>++</code> each returning a new Server overriding any default configuration. (More properties are given in the <a href="#server-configurations">Server Configurations</a> section below.)<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">private val server =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Server.port(PORT) ++              // Setup port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Server.maxRequestSize(8 * 1024) ++ // handle max request size of 8 KB (default 4 KB)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Server.app(fooBar ++ app)       // Setup the Http app</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>And then use <code>Server.make</code> to get a &quot;managed&quot; instance use it to run a server forever<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">override def run(args: List[String]): URIO[zio.ZEnv, ExitCode] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server.make</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .use(start =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      console.putStrLn(s&quot;Server started on port ${start.port}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      *&gt; ZIO.never,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ).provideCustomLayer(ServerChannelFactory.auto ++ EventLoopGroup.auto(2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .exitCode</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><strong>Tip :</strong> <code>ServerChannelFactory.auto ++ EventLoopGroup.auto(num Threads)</code> is supplied as an external dependency to choose netty transport type. One can leave it as <code>auto</code> to let the application handle it for you.
Also in <code>EventLoopGroup.auto(numThreads)</code> you can choose number of threads based on number of available processors. </li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="binding-server-to-a-socket-address">Binding Server to a socket address<a aria-hidden="true" class="hash-link" href="#binding-server-to-a-socket-address" title="Direct link to heading">â€‹</a></h3><p>One can bind server to Inet address in multiple ways, either by providing a port number or </p><ul><li>If no port is provided, the default port is 8080</li><li>If specified port is 0, it will use a dynamically selected port.</li></ul><details class="details_Q743 alert alert--info details_h+cY" data-collapsed="true"><summary><b>A complete example </b></summary><div><div class="collapsibleContent_K5uX"><ul><li>Example below shows how the server can be started in forever mode to serve HTTP requests:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import zio.http._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import zio.http.service._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import zio.http.service.ServerChannelFactory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import zio._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import scala.util.Try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object HelloWorldAdvanced extends App {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Set a port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private val PORT = 8090</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private val fooBar: HttpApp[Any, Nothing] = Http.collect[Request] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Method.GET -&gt; !! / &quot;foo&quot; =&gt; Response.text(&quot;bar&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Method.GET -&gt; !! / &quot;bar&quot; =&gt; Response.text(&quot;foo&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private val app = Http.collectM[Request] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Method.GET -&gt; !! / &quot;random&quot; =&gt; random.nextString(10).map(Response.text)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Method.GET -&gt; !! / &quot;utc&quot;    =&gt; clock.currentDateTime.map(s =&gt; Response.text(s.toString))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private val server =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Server.port(PORT) ++              // Setup port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Server.paranoidLeakDetection ++ // Paranoid leak detection (affects performance)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Server.app(fooBar +++ app)      // Setup the Http app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override def run(args: List[String]): URIO[zio.ZEnv, ExitCode] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Configure thread count using CLI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val nThreads: Int = args.headOption.flatMap(x =&gt; Try(x.toInt).toOption).getOrElse(0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Create a new server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server.make</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .use(_ =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              // Waiting for the server to start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              console.putStrLn(s&quot;Server started on port $PORT&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      // Ensures the server doesn&#x27;t die after printing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      *&gt; ZIO.never,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .provideCustomLayer(ServerChannelFactory.auto ++ EventLoopGroup.auto(nThreads))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .exitCode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></details><h2 class="anchor anchorWithStickyNavbar_y2LR" id="server-configurations">Server Configurations<a aria-hidden="true" class="hash-link" href="#server-configurations" title="Direct link to heading">â€‹</a></h2><table><thead><tr><th><strong>Configuration</strong></th><th><strong>Purpose and usage</strong></th></tr></thead><tbody><tr><td><code>Server.app(httpApp)</code></td><td>Mount routes. Refer to complete example above</td></tr><tr><td><code>Server.maxRequestSize(8 * 1024)</code></td><td>handle max request size of 8 KB (default 4 KB)</td></tr><tr><td><code>Server.port(portNum)</code> or <code>Server.bind(portNum)</code></td><td>Bind server to the port, refer to examples above</td></tr><tr><td><code>Server.ssl(sslOptions)</code></td><td>Creates a new server with ssl options. <a href="https://github.com/zio/zio-http/blob/main/example/src/main/scala/example/HttpsHelloWorld.scala" target="_blank" rel="noopener noreferrer">HttpsHelloWorld</a></td></tr><tr><td><code>Server.acceptContinue</code></td><td>Sends a <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.2.3" target="_blank" rel="noopener noreferrer">100 CONTINUE</a></td></tr><tr><td><code>Server.disableFlowControl</code></td><td>Refer <a href="https://netty.io/4.1/api/io/netty/handler/flow/FlowControlHandler.html" target="_blank" rel="noopener noreferrer">Netty FlowControlHandler</a></td></tr><tr><td><code>Server.disableLeakDetection</code></td><td>Disable any leak detection Refer netty&#x27;s <a href="https://netty.io/4.0/api/io/netty/util/ResourceLeakDetector.Level.html" target="_blank" rel="noopener noreferrer">ResourceLeakDetector</a></td></tr><tr><td><code>Server.simpleLeakDetection</code></td><td>Simplistic leak detection comes with small over head. Refer netty&#x27;s <a href="https://netty.io/4.0/api/io/netty/util/ResourceLeakDetector.Level.html" target="_blank" rel="noopener noreferrer">ResourceLeakDetector</a></td></tr><tr><td><code>Server.paranoidLeakDetection</code></td><td>Comes with highest possible overhead (for testing purposes only). Refer netty&#x27;s <a href="https://netty.io/4.0/api/io/netty/util/ResourceLeakDetector.Level.html" target="_blank" rel="noopener noreferrer">ResourceLeakDetector</a></td></tr><tr><td><code>Server.consolidateFlush</code></td><td>Flushing content is done in batches. Can potentially improve performance.</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zio-http/docs/v1.x/getting-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Getting Started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zio-http/docs/v1.x/dsl/http"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Http<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#start-a-zio-http-server-with-default-configurations" class="table-of-contents__link toc-highlight">Start a ZIO HTTP Server with default configurations</a></li><li><a href="#start-a-zio-http-server-with-custom-configurations" class="table-of-contents__link toc-highlight">Start a ZIO HTTP Server with custom configurations.</a><ul><li><a href="#binding-server-to-a-socket-address" class="table-of-contents__link toc-highlight">Binding Server to a socket address</a></li></ul></li><li><a href="#server-configurations" class="table-of-contents__link toc-highlight">Server Configurations</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zio-http/docs/v1.x/index">Documents</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.com/channels/629491597070827530/819703129267372113" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/zio-http/assets/js/runtime~main.f417ffbd.js"></script>
<script src="/zio-http/assets/js/main.9c568309.js"></script>
</body>
</html>